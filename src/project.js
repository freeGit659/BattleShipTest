window.__require=function t(e,n,i){function o(r,c){if(!n[r]){if(!e[r]){var a=r.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+r+"'")}}var l=n[r]={exports:{}};e[r][0].call(l.exports,function(t){return o(e[r][1][t]||t)},l,l.exports,t,e,n,i)}return n[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function s(t){return"number"==typeof t}function r(t){return"object"==typeof t&&null!==t}function c(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!s(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,s,a,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(c(n=this._events[t]))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),i=(h=n.slice()).length,a=0;a<i;a++)h[a].apply(this,s);return!0},i.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(n=c(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){if(!o(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var n,i,s,c;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,i=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(n)){for(c=s;c-- >0;)if(n[c]===e||n[c].listener&&n[c].listener===e){i=c;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(o(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){(function(t,i){"object"==typeof n&&"object"==typeof e?e.exports=i():"function"==typeof define&&define.amd?define("StateMachine",[],i):"object"==typeof n?n.StateMachine=i():t.StateMachine=i()})(this,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";t.exports=function(t,e){var n,i,o;for(n=1;n<arguments.length;n++)for(o in i=arguments[n])i.hasOwnProperty(o)&&(t[o]=i[o]);return t}},function(t,e,n){"use strict";var i=n(0);t.exports={build:function(t,e){var n,o,s,r=e.plugins;for(n=0,o=r.length;n<o;n++)(s=r[n]).methods&&i(t,s.methods),s.properties&&Object.defineProperties(t,s.properties)},hook:function(t,e,n){var i,o,s,r,c=t.config.plugins,a=[t.context];for(n&&(a=a.concat(n)),i=0,o=c.length;i<o;i++)r=c[i],(s=c[i][e])&&s.apply(r,a)}}},function(t,e,n){"use strict";function i(t){if(0===t.length)return t;var e,n,i=t.split(/[_-]/);if(1===i.length&&i[0][0].toLowerCase()===i[0][0])return t;for(n=i[0].toLowerCase(),e=1;e<i.length;e++)n=n+i[e].charAt(0).toUpperCase()+i[e].substring(1).toLowerCase();return n}i.prepended=function(t,e){return t+(e=i(e))[0].toUpperCase()+e.substring(1)},t.exports=i},function(t,e,n){"use strict";var i=n(0),o=n(2);function s(t,e){t=t||{},this.options=t,this.defaults=e.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(t.init),this.data=this.configureData(t.data),this.methods=this.configureMethods(t.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(t.transitions||[]),this.plugins=this.configurePlugins(t.plugins,e.plugin)}i(s.prototype,{addState:function(t){this.map[t]||(this.states.push(t),this.addStateLifecycleNames(t),this.map[t]={})},addStateLifecycleNames:function(t){this.lifecycle.onEnter[t]=o.prepended("onEnter",t),this.lifecycle.onLeave[t]=o.prepended("onLeave",t),this.lifecycle.on[t]=o.prepended("on",t)},addTransition:function(t){this.transitions.indexOf(t)<0&&(this.transitions.push(t),this.addTransitionLifecycleNames(t))},addTransitionLifecycleNames:function(t){this.lifecycle.onBefore[t]=o.prepended("onBefore",t),this.lifecycle.onAfter[t]=o.prepended("onAfter",t),this.lifecycle.on[t]=o.prepended("on",t)},mapTransition:function(t){var e=t.name,n=t.from,i=t.to;return this.addState(n),"function"!=typeof i&&this.addState(i),this.addTransition(e),this.map[n][e]=t,t},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(t){return"string"==typeof t?this.mapTransition(i({},this.defaults.init,{to:t,active:!0})):"object"==typeof t?this.mapTransition(i({},this.defaults.init,t,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(t){return"function"==typeof t?t:"object"==typeof t?function(){return t}:function(){return{}}},configureMethods:function(t){return t||{}},configurePlugins:function(t,e){var n,i,o;for(n=0,i=(t=t||[]).length;n<i;n++)"function"==typeof(o=t[n])&&(t[n]=o=o()),o.configure&&o.configure(this);return t},configureTransitions:function(t){var e,n,i,o,s,r=this.defaults.wildcard;for(n=0;n<t.length;n++)for(i=t[n],o=Array.isArray(i.from)?i.from:[i.from||r],s=i.to||r,e=0;e<o.length;e++)this.mapTransition({name:i.name,from:o[e],to:s})},transitionFor:function(t,e){var n=this.defaults.wildcard;return this.map[t][e]||this.map[n][e]},transitionsFor:function(t){var e=this.defaults.wildcard;return Object.keys(this.map[t]).concat(Object.keys(this.map[e]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),t.exports=s},function(t,e,n){var i=n(0),o=n(6),s=n(1),r=[null,[]];function c(t,e){this.context=t,this.config=e,this.state=e.init.from,this.observers=[t]}i(c.prototype,{init:function(t){if(i(this.context,this.config.data.apply(this.context,t)),s.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(t){return Array.isArray(t)?t.indexOf(this.state)>=0:this.state===t},isPending:function(){return this.pending},can:function(t){return!this.isPending()&&!!this.seek(t)},cannot:function(t){return!this.can(t)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(t,e){var n=this.config.defaults.wildcard,i=this.config.transitionFor(this.state,t),o=i&&i.to;return"function"==typeof o?o.apply(this.context,e):o===n?this.state:o},fire:function(t,e){return this.transit(t,this.state,this.seek(t,e),e)},transit:function(t,e,n,i){var o=this.config.lifecycle,s=this.config.options.observeUnchangedState||e!==n;return n?this.isPending()?this.context.onPendingTransition(t,e,n):(this.config.addState(n),this.beginTransit(),i.unshift({transition:t,from:e,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(o.onBefore.transition),this.observersForEvent(o.onBefore[t]),s?this.observersForEvent(o.onLeave.state):r,s?this.observersForEvent(o.onLeave[e]):r,this.observersForEvent(o.on.transition),s?["doTransit",[this]]:r,s?this.observersForEvent(o.onEnter.state):r,s?this.observersForEvent(o.onEnter[n]):r,s?this.observersForEvent(o.on[n]):r,this.observersForEvent(o.onAfter.transition),this.observersForEvent(o.onAfter[t]),this.observersForEvent(o.on[t])],i)):this.context.onInvalidTransition(t,e,n)},beginTransit:function(){this.pending=!0},endTransit:function(t){return this.pending=!1,t},failTransit:function(t){throw this.pending=!1,t},doTransit:function(t){this.state=t.to},observe:function(t){if(2===t.length){var e={};e[t[0]]=t[1],this.observers.push(e)}else this.observers.push(t[0])},observersForEvent:function(t){for(var e,n=0,i=this.observers.length,o=[];n<i;n++)(e=this.observers[n])[t]&&o.push(e);return[t,o,!0]},observeEvents:function(t,e,n,i){if(0===t.length)return this.endTransit(void 0===i||i);var o=t[0][0],r=t[0][1],c=t[0][2];if(e[0].event=o,o&&c&&o!==n&&s.hook(this,"lifecycle",e),0===r.length)return t.shift(),this.observeEvents(t,e,o,i);var a=r.shift(),h=a[o].apply(a,e);return h&&"function"==typeof h.then?h.then(this.observeEvents.bind(this,t,e,o)).catch(this.failTransit.bind(this)):!1===h?this.endTransit(!1):this.observeEvents(t,e,o,h)},onInvalidTransition:function(t,e,n){throw new o("transition is invalid in current state",t,e,n,this.state)},onPendingTransition:function(t,e,n){throw new o("transition is invalid while previous transition is still in progress",t,e,n,this.state)}}),t.exports=c},function(t,e,n){"use strict";var i=n(0),o=n(2),s=n(1),r=n(3),c=n(4),a={is:function(t){return this._fsm.is(t)},can:function(t){return this._fsm.can(t)},cannot:function(t){return this._fsm.cannot(t)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(t,e,n){return this._fsm.onInvalidTransition(t,e,n)},onPendingTransition:function(t,e,n){return this._fsm.onPendingTransition(t,e,n)}},h={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(t){throw Error("use transitions to change state")}}};function l(t){return p(this||{},t)}function p(t,e){return u(t,new r(e,l)),t._fsm(),t}function u(t,e){if("object"!=typeof t||Array.isArray(t))throw Error("StateMachine can only be applied to objects");s.build(t,e),Object.defineProperties(t,h),i(t,a),i(t,e.methods),e.allTransitions().forEach(function(e){t[o(e)]=function(){return this._fsm.fire(e,[].slice.call(arguments))}}),t._fsm=function(){this._fsm=new c(this,e),this._fsm.init(arguments)}}l.version="3.0.1",l.factory=function(){var t,e;"function"==typeof arguments[0]?(t=arguments[0],e=arguments[1]||{}):(t=function(){this._fsm.apply(this,arguments)},e=arguments[0]||{});var n=new r(e,l);return u(t.prototype,n),t.prototype._fsm.config=n,t},l.apply=p,l.defaults={wildcard:"*",init:{name:"init",from:"none"}},t.exports=l},function(t,e,n){"use strict";t.exports=function(t,e,n,i,o){this.message=t,this.transition=e,this.from=n,this.to=i,this.current=o}}])})},{}],AnimationState:[function(t,e,n){"use strict";cc._RF.push(e,"c8c0dbE11ZGWos16acETK+A","AnimationState");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.myanimation=this.node.getComponent(cc.Animation),this.myanimation.on("finished",this.onAnimationFinished,this)},onAnimationFinished:function(){i.instance.emit(o.DESTROY_ANI_NODE)},start:function(){}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],Bom:[function(t,e,n){"use strict";cc._RF.push(e,"1406cSnn/9J4ai6owU5xElI","Bom");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{bomSprite:cc.SpriteFrame},onLoad:function(){i.instance.registerOnce("attackToPosition",this.onAttack.bind(this))},start:function(){this.animation=this.node.getComponent(cc.Animation),this.animation.on("finished",this.onAnimationFinished,this)},onAnimationFinished:function(t){this.node.getComponent(cc.Sprite).spriteFrame=this.bomSprite},onAttack:function(t){var e=this;cc.tween(this.node).delay(.94).parallel(cc.tween().to(2,{position:t.worldPosition}),cc.tween().to(.75,{scale:2},{easing:"sineOut"}).then(cc.tween().to(1.25,{scale:.5},{easing:"sineIn"})),cc.tween().to(2,{angle:2520})).call(function(){e.playAnimationtileTarget(t),e.node.destroy()}).start()},playAnimationtileTarget:function(t){i.instance.emit(o.PLAY_ANI,t)},onDestroy:function(){}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],ClockController:[function(t,e,n){"use strict";cc._RF.push(e,"190aaYlrFFMXZeRZWB/kGQ6","ClockController");t("EventEmitter"),t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{coldDownTime:11}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],Emitter:[function(t,e,n){"use strict";cc._RF.push(e,"f7614fPTuhAM7fVukeQeDEN","Emitter");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.mousePos=cc.v2(0,0),this.node.on("mousedown",this.onMouseDown,this)},onDestroy:function(){this.node.off(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this)},onMouseDown:function(t){this.mousePos=t.getLocation(),i.instance.emit("takePosition",this.mousePos)}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],EnemyController:[function(t,e,n){"use strict";cc._RF.push(e,"7acce/yl7JAVZd3Girhwtbu","EnemyController");var i=t("EventEmitter"),o=t("NAME_EVENT"),s=t("rands"),r=s.randomPosition,c=s.randomHitShip;cc.Class({extends:cc.Component,properties:{_isHitting:!1,_hitShips:{default:{}},_saveHitPos:[],_maxRow:8,_maxColumn:8},onLoad:function(){this.enemyId=Math.floor(Math.random()*Date.now()).toString();var t=this.chooseCoordinates.bind(this);i.instance.registerEvent(o.CHOOSE_COORDINATES,t);var e=this.onCompleteHitShip.bind(this);i.instance.registerEvent(o.COMPLETE_HIT_SHIP,e);var n=this.onHitShip.bind(this);i.instance.registerEvent(o.HIT_SHIP,n),i.instance.registerEvent("receiveresult",this.responeResult.bind(this))},start:function(){i.instance.emit("setEnemyId",this.enemyId)},chooseCoordinates:function(){var t=null;do{t=this._isHitting?c(this._hitShips,this._maxRow,this._maxColumn):r(this._maxRow,this._maxColumn)}while(this.hasHitShip(t));this._saveHitPos.push(t),cc.log("enemy shoot",t),i.instance.emit(o.POSITION,{position:{x:t.column,y:t.row}})},hasHitShip:function(t){return this._saveHitPos.some(function(e){return e.row===t.row&&e.column===t.column})},onHitShip:function(t){var e=t.shipId,n=t.position;this._hitShips[e]?this._hitShips[e].push(n):this._hitShips[e]=[n],this._isHitting=!0},onCompleteHitShip:function(t){delete this._hitShips[t],0===Object.keys(this._hitShips).length&&(this._isHitting=!1)},responeResult:function(t){if(this.enemyId==t.playerId)if(null==t.shipId)cc.log("hut"),i.instance.emit(o.SEND_RESULT,{isHit:!1,worldPosition:t.worldPosition});else{var e={};i.instance.emit("updateLength",t.shipId,e);var n=e.length;0==n?(cc.log("no"),i.instance.emit(o.SEND_RESULT,{isHit:!0,worldPosition:t.worldPosition,shipLength:n}),i.instance.emit("showShip",{shipId:t.shipId})):(cc.log("trung"),i.instance.emit(o.SEND_RESULT,{isHit:!0,worldPosition:t.worldPosition,shipLength:n}))}}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT",rands:"rands"}],EnemyMap:[function(t,e,n){"use strict";cc._RF.push(e,"56e98JPQ6ZNiqrHU2yZSp6F","EnemyMap");var i=t("EventEmitter");t("Ship");cc.Class({extends:cc.Component,properties:{rows:8,cols:8,tilePrefab:cc.Prefab},onLoad:function(){var t=this;this.map=new Array(this.rows).fill(null).map(function(){return new Array(t.cols).fill(null)}),this.enemyId=null,this.creatMap();var e=this.setShip.bind(this);i.instance.registerEvent("set-enemy-ship-pos",e),i.instance.registerEvent("checkTile",this.checkTile.bind(this)),i.instance.registerEvent("setEnemyId",function(e){return t.enemyId=e}),i.instance.registerEvent("log-enemy-map",function(){return cc.log("random ship",t.map.map(function(t){return t.map(function(t){return t.getComponent("Tile").shipId})}))})},start:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},onTouchEnd:function(t){cc.log("co nhan");var e=t.getLocation(),n=this.node.convertToNodeSpaceAR(e);this.convertPosition(n)},convertPosition:function(t){var e=t.x-30,n=t.y+30,o=Math.round(e/55),s=Math.round(n/55);cc.log(o,s),this.map[-1*s][o].getComponent("Tile").isShooted?cc.log("\xf4 n\xe0y \u0111\xe3 b\u1ecb b\u1eafn"):(cc.log("G\u1eedi cho player c\xf3 th\u1ec3 b\u1eafn"),i.instance.emit("sendCoordinates",{x:o,y:-s}))},test:function(){this.node.active=!this.node.active},getRandomIntegerInRange:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},creatMap:function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.cols;e++){var n=cc.instantiate(this.tilePrefab);this.map[t][e]=n,n.parent=this.node}},setShip:function(t){if(t.isSuccess=this.checkAvailable(t.arrayPos),t.isSuccess){this.addToShipBool(t);for(var e=0;e<t.arrayPos.length;e++){this.map[t.arrayPos[e].y][t.arrayPos[e].x].getComponent("Tile").shipId=t.shipId}}},addToShipBool:function(t){var e=Math.floor(t.arrayPos.length/2),n=t.arrayPos[e].x,o=t.arrayPos[e].y+1,s=new cc.Vec2(55*n+25,-55*o+25);cc.log(s);var r=!0;1!=t.arrayPos.length&&t.arrayPos[e].y!=t.arrayPos[e-1].y&&(r=!1),i.instance.emit("addShipBool",{shipId:t.shipId,length:t.arrayPos.length,position:s,isHorizontal:r})},checkAvailable:function(t){for(var e=0;e<t.length;e++){if(t[e].y<0||t[e].y>=this.rows||t[e].x<0||t[e].x>=this.rows)return!1;if(null!=this.map[t[e].y][t[e].x].getComponent("Tile").shipId)return!1}return!0},checkTile:function(t){if(this.enemyId==t.playerId){var e=this.map[t.position.y][t.position.x],n=new cc.Vec2(e.x+this.node.x,e.y+this.node.y),o=new cc.Vec2(n.x+this.node.parent.x,n.y+this.node.parent.y),s=new cc.Vec2(o.x+this.node.parent.parent.x,o.y+this.node.parent.parent.y),r=e.getComponent("Tile").shipId;cc.log("enemy ship",r),i.instance.emit("receiveresult",{playerId:this.enemyId,worldPosition:s,shipId:r}),e.getComponent("Tile").isShooted=!0,cc.tween(this.node).delay(3).call(function(){e.getComponent("Tile").changeState()}).start()}}}),cc._RF.pop()},{EventEmitter:"EventEmitter",Ship:"Ship"}],EnemyShipBool:[function(t,e,n){"use strict";cc._RF.push(e,"b182auVPGJFjIAGNABvHI9H","EnemyShipBool");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{shipPefab:[cc.Prefab]},onLoad:function(){this.shipBool={},i.instance.registerEvent("addShipBool",this.setShip.bind(this)),i.instance.registerEvent("showShip",this.showShip.bind(this))},start:function(){},setShip:function(t){var e=this.shipPefab.length-t.length,n=cc.instantiate(this.shipPefab[e]);n.parent=this.node,cc.log(t.position),n.position=t.position,t.isHorizontal||(n.rotation=90),this.shipBool[t.shipId]=n,n.getComponent("EnemyShipDisplay").displayShip(!1)},showShip:function(t){var e=this;cc.tween(this.node).delay(3).call(function(){e.shipBool[t.shipId].getComponent("EnemyShipDisplay").displayShip(!0)}).start()}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],EnemyShipDisplay:[function(t,e,n){"use strict";cc._RF.push(e,"ec274RAA99FIYdwpCtqqTID","EnemyShipDisplay"),cc.Class({extends:cc.Component,properties:{shipSprite:cc.Node},displayShip:function(t){this.shipSprite.active=t}}),cc._RF.pop()},{}],EventCode:[function(t,e,n){"use strict";cc._RF.push(e,"705cdpL21lGv5hohkQ2CxUp","EventCode"),e.exports={},cc._RF.pop()},{}],EventController:[function(t,e,n){"use strict";cc._RF.push(e,"1a5e6v4yb9Hr5MMTg0lMgs9","EventController");var i=t("EventEmitter");cc.Class({extends:cc.Component,onLoad:function(){i.instance=new i}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],EventEmitter:[function(t,e,n){"use strict";cc._RF.push(e,"b75617FkbdJ/qiEsWbv+Fn4","EventEmitter");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=t("events"),r=function(){function t(){o(this,t),this._emitter=new s,this._emitter.setMaxListeners(100)}return i(t,[{key:"emit",value:function(){var t;(t=this._emitter).emit.apply(t,arguments)}},{key:"registerEvent",value:function(t,e){this._emitter.on(t,e)}},{key:"registerOnce",value:function(t,e){this._emitter.once(t,e)}},{key:"removeEvent",value:function(t,e){this._emitter.removeListener(t,e)}},{key:"destroy",value:function(){this._emitter.removeAllListeners(),this._emitter=null,t.instance=null}}]),t}();r.instance=null,e.exports=r,cc._RF.pop()},{events:1}],FindTileInMap:[function(t,e,n){"use strict";cc._RF.push(e,"05567AzhmZAAKNEj79+RLfw","FindTileInMap");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{spritePrefab:cc.Prefab},onLoad:function(){this.node.on("mousedown",this.onMouseDown,this)},onMouseDown:function(t){if(t.getButton()===cc.Event.EventMouse.BUTTON_LEFT){this.mousePosition=t.getLocation();var e={playerId:0,position:this.mousePosition};i.instance.emit(o.POSITION,e),t.stopPropagation()}}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],GameController:[function(t,e,n){"use strict";cc._RF.push(e,"b4d16jmiWZC66S4QCxEkEZc","GameController");var i=t("EventEmitter"),o=t("NAME_EVENT"),s=t("javascript-state-machine");cc.Class({extends:cc.Component,properties:{ballCannon:cc.Prefab,mapEnemy:cc.Node,mapPlayer:cc.Node,changeSceneNode:cc.Node,pirate:sp.Skeleton,clockPlayer:cc.Label,clockEnemy:cc.Label},onLoad:function(){var t=this;cc.log(i),this.playerId=0,this.enemyId=1,this._shipPlayerCounter=4,this._shipEnemyCounter=4,i.instance.registerOnce("setEnemyId",function(e){t.enemyId=e}),i.instance.registerOnce(o.START,this.setPlayerIdStartGame.bind(this)),i.instance.registerEvent(o.CHANGE_SCENE,this.changeScene.bind(this)),i.instance.registerEvent(o.SEND_RESULT,this.playAnimation.bind(this)),i.instance.registerEvent(o.RESET_TURN,this.restTurn.bind(this)),i.instance.registerEvent(o.SHIP_FAIL_CHECK,this.changeSceneShipFail.bind(this)),this.fsm=new s({init:"init",transitions:[{name:"changePlayerScene",from:["init","enemyScene","shipFailScene","playerScene"],to:"playerScene"},{name:"changeEnemyScene",from:["init","playerScene","shipFailScene","enemyScene"],to:"enemyScene"},{name:"changeEndScene",from:["playerScene","enemyScene","shipFailScene"],to:"endScene"},{name:"changeShipFailScene",from:["playerScene","enemyScene"],to:"shipFailScene"}],methods:{onChangePlayerScene:this.onChangePlayerScene.bind(this),onChangeEnemyScene:this.onChangeEnemyScene.bind(this),onChangeShipFailScene:this.changeSceneShipFail.bind(this)}})},setPlayerIdStartGame:function(t){var e=this;this.playerId=t,cc.log(this.playerId),this.pirate.node.active=!1,this.mapPlayer.active=!1,this.mapEnemy.active=!1,i.instance.emit(o.WAIT_FOR_ENEMY),i.instance.registerOnce(o.WAIT_FOR_ENEMY_DONE,function(){e.fsm.changePlayerScene()})},onChangePlayerScene:function(){var t=this;cc.log("chuyen player"),this.pirate.node.active=!1,this.mapEnemy.active=!1,this.mapPlayer.active=!1,i.instance.emit(o.YOUR_TURN_PANEL),i.instance.registerOnce(o.YOUR_TURN_PANEL_DONE,function(){t.mapEnemy.active=!0,t.pirate.node.active=!0;var e=t.pirate.node.getComponent(sp.Skeleton);i.instance.registerOnce(o.POSITION,function(n){n.playerId=t.enemyId,e.clearTracks(),e.setAnimation(0,"Attack_2",!1),e.addAnimation(0,"Idle",!0),i.instance.emit("checkTile",n)})})},onChangeEnemyScene:function(){var t=this;cc.log("chuyen enemy"),this.pirate.node.active=!1,this.mapEnemy.active=!1,this.mapPlayer.active=!1,i.instance.emit(o.ENEMY_TURN_PANEL),i.instance.registerOnce(o.ENEMY_TURN_PANEL_DONE,function(){t.mapPlayer.active=!0,t.pirate.node.active=!0,i.instance.registerOnce(o.POSITION,function(e){e.playerId=t.playerId,i.instance.emit(o.CHECK_POSITION,e),cc.log("playerId EnemyScene",e.playerId)}),cc.tween(t.node).call(function(){}).delay(1.5).call(function(){i.instance.emit(o.CHOOSE_COORDINATES);var e=t.pirate.node.getComponent(sp.Skeleton);e.clearTracks(),e.setAnimation(0,"Attack_2",!1),e.addAnimation(0,"Idle",!0)}).start()})},playAnimation:function(t){cc.log(t),cc.log("goi h\xe0m playAn");var e=cc.director.getScene(),n=cc.instantiate(this.ballCannon);n.setParent(e),n.position=cc.v2(450,100),i.instance.emit(o.SOUND_CANON_SHOOT),i.instance.emit("attackToPosition",t)},restTurn:function(){"playerScene"===this.fsm.state&&this.fsm.changePlayerScene(),"enemyScene"===this.fsm.state&&this.fsm.changeEnemyScene()},changeScene:function(t){cc.log("map qu\xe1i: "+this.mapEnemy.active),this.mapEnemy.active===t?(cc.log("\u0111\u1ed5i enemy"),this.fsm.changeEnemyScene()):(cc.log("\u0111\u1ed5i player"),this.fsm.changePlayerScene())},changeSceneShipFail:function(){"playerScene"===this.fsm.state?(this._shipEnemyCounter--,cc.log(this.__shipEnemyCounter),0===this._shipEnemyCounter?this.onChangeEndScene(!0):this.fsm.changePlayerScene()):"enemyScene"===this.fsm.state&&(this._shipPlayerCounter--,0===this._shipPlayerCounter?this.onChangeEndScene(!1):this.fsm.changeEnemyScene())},onChangeEndScene:function(t){!0===t?i.instance.emit(o.WIN):i.instance.emit(o.LOSE)}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT","javascript-state-machine":2}],LoadEnemyShip:[function(t,e,n){"use strict";cc._RF.push(e,"68262yE7rlDYq+4k/aYdhPM","LoadEnemyShip");var i=t("Ship"),o=t("rands").randomPosition,s=t("EventEmitter");cc.Class({extends:cc.Component,properties:{shipPool:[i]},onLoad:function(){this.shipPool.push(new i(4)),this.shipPool.push(new i(3)),this.shipPool.push(new i(2)),this.shipPool.push(new i(1)),s.instance.registerEvent("updateLength",this.updateLength.bind(this))},start:function(){this.onRandomShips(),s.instance.emit("log-enemy-map")},onRandomShips:function(){var t=this;this.shipPool.forEach(function(e){t.onRandomShip(e)})},onRandomShip:function(t){t.isHorizontal=Math.random()<.5;var e={isSuccess:!1};do{var n=o(8,8);t.calculatePosition(n.column,n.row,!1),e.arrayPos=t.positions,e.shipId=t.shipId,s.instance.emit("set-enemy-ship-pos",e)}while(!e.isSuccess)},getShipById:function(t){for(var e=0;e<this.shipPool.length;e++)if(this.shipPool[e].shipId==t)return this.shipPool[e]},updateLength:function(t,e){var n=this.getShipById(t);n.length-=1,e.length=n.length}}),cc._RF.pop()},{EventEmitter:"EventEmitter",Ship:"Ship",rands:"rands"}],MainController:[function(t,e,n){"use strict";cc._RF.push(e,"98e5cqmZ81PPIEflGIGtiX7","MainController");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{},onLoad:function(){i.instance=new i}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],MapController:[function(t,e,n){"use strict";cc._RF.push(e,"5d092iN871DLLkPyO55TuIQ","MapController");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{clickCounter:1},onLoad:function(){i.instance.registerEvent(o.RESET_TURN,this.resetTurn.bind(this)),cc.tween(this.node).to(2,{scaleX:2}).start()},resetTurn:function(){this.clickCounter=1},onEnable:function(){this.resetTurn(),cc.log("map enable "+this.node.name)}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],Map:[function(t,e,n){"use strict";cc._RF.push(e,"b248ah+AQtI06v5J+NxHvCe","Map");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{rows:9,cols:9,tilePrefab:cc.Prefab,selectedTiles:[cc.Node]},onLoad:function(){var t=this;this.map=new Array(this.rows).fill(null).map(function(){return new Array(t.cols).fill(null)}),cc.log(this.map),this.isAvailable=!0,this.playerId=null,this.creatMap()},start:function(){i.instance.registerEvent("selected",this.addSelectedTile.bind(this)),i.instance.registerEvent("setShipId",this.setShipId.bind(this)),i.instance.registerEvent("clear",this.removeAllSelectedTile.bind(this)),i.instance.registerEvent("clearShipId",this.clearShipId.bind(this)),i.instance.registerEvent("checkTile",this.checkTile.bind(this)),i.instance.registerEvent("SavePlayerId",this.savePlayerId.bind(this))},creatMap:function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.cols;e++){var n=cc.instantiate(this.tilePrefab);this.map[t][e]=n,n.parent=this.node}},removeAllSelectedTile:function(){this.selectedTiles.length>=0&&(this.selectedTiles.forEach(function(t){t.getComponent("Tile").active(!1)}),this.selectedTiles.length=0)},addSelectedTile:function(t){var e=this;this.removeAllSelectedTile(),this.isAvailable=!0,this.checkAvailable(t.positions,t.shipId),this.selectedTiles.forEach(function(t){e.isAvailable?(t.getComponent("Tile").activeColor=cc.color(0,255,0,180),t.getComponent("Tile").active(!0)):(t.getComponent("Tile").activeColor=cc.color(255,0,0,180),t.getComponent("Tile").active(!0))}),i.instance.emit("setAvailable",{isAvailable:this.isAvailable,shipId:t.shipId})},checkAvailable:function(t,e){for(var n=this,i=0;i<t.length;i++)t[i].y<0||t[i].y>=this.rows||t[i].x<0||t[i].x>=this.rows?this.isAvailable=!1:this.selectedTiles.push(this.map[t[i].y][t[i].x]);this.selectedTiles.forEach(function(t){null!=t.getComponent("Tile").shipId&&t.getComponent("Tile").shipId!=e&&(n.isAvailable=!1)})},clearShipId:function(t){cc.log("clear:",t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.cols;n++)this.map[e][n].getComponent("Tile").shipId==t&&(cc.log("clear"),this.map[e][n].getComponent("Tile").shipId=null)},setShipId:function(t){var e=this;cc.log("setShipid"),this.removeAllSelectedTile(),this.clearShipId(t.shipId),t.positions.forEach(function(n){e.map[n.y][n.x].getComponent("Tile").shipId=t.shipId})},checkTile:function(t){if(this.playerId==t.playerId){var e=this.map[t.position.y][t.position.x],n=new cc.Vec2(e.x+this.node.x,e.y+this.node.y),o=new cc.Vec2(n.x+this.node.parent.x,n.y+this.node.parent.y),s=new cc.Vec2(o.x+this.node.parent.parent.x,o.y+this.node.parent.parent.y),r=e.getComponent("Tile").shipId;i.instance.emit("receiveresult",{playerId:this.playerId,worldPosition:s,shipId:r,position:t.position}),cc.tween(this.node).delay(3).call(function(){e.getComponent("Tile").changeState()}).start()}},savePlayerId:function(t){cc.log("save player id"),this.playerId=t}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],NAME_EVENT:[function(t,e,n){"use strict";cc._RF.push(e,"29a6cBl6qxERYDFp8PhUrlL","NAME_EVENT");e.exports={IS_SHOOT_SHIP:"FINISH_SHOOT",RESET_TURN:"RESET_TURN",CHANGE_SCENE:"CHANGE_SCENE",COLD_DOWN_CLOCK:"COLD_DOWN_CLOCK",STOP_CLOCK:"STOP_CLOCK",RESET_TURN_CLOCK:"RESET_TURN_CLOCK",CHANGE_SCENE_CLOCK:"CHANGE_SCENE_CLOCK",POSITION:"POSITION",SEND_RESULT:"SEND_RESULT",CHECK_POSITION:"CHECK_POSITION",PLAY_ANI:"PLAY_ANI",DESTROY_ANI_NODE:"DESTROY_ANI_NODE",SHIP_FAIL:"SHIP_FAIL",SHIP_FAIL_CHECK:"SHIP_FAIL_CHECK",START:"START",COMPLETE_HIT_SHIP:"complete-hit-ship",HIT_SHIP:"hit-ship",CHOOSE_COORDINATES:"choose-coordinates",YOUR_TURN_PANEL:"UI-yourTurn",YOUR_TURN_PANEL_DONE:"UI-yourTurnDone",ENEMY_TURN_PANEL:"UI-enemyTurn",ENEMY_TURN_PANEL_DONE:"UI-enemyTurnDone",WAIT_FOR_ENEMY:"UI-waitForEnemy",WAIT_FOR_ENEMY_DONE:"UI-waitForEnemyDone",SOUND_CANON_SHOOT:"SOUND_CANON_SHOOT",SOUND_SHOOT_WATER:"SOUND_SHOOT_WATER",SOUND_EXPLOSION:"SOUND_EXPLOSION",SOUND_CLICK:"SOUND_CLICK",WIN:"WIN",LOSE:"LOSE"},cc._RF.pop()},{}],PirateContoller:[function(t,e,n){"use strict";cc._RF.push(e,"14c43CiLyBCPadjuyd/ct6y","PirateContoller");var i=t("EventEmitter"),o=(t("javascript-state-machine"),t("NAME_EVENT"));cc.Class({extends:cc.Component,properties:{},onEnable:function(){var t=this.node.getComponent(sp.Skeleton);t.clearTracks(),t.setAnimation(0,"Idle",!0)},onLoad:function(){i.instance.registerEvent(o.IS_SHOOT_SHIP,this.handleState.bind(this)),i.instance.registerEvent(o.CHANGE_SCENE_CLOCK,this.handleState.bind(this)),i.instance.registerEvent(o.SHIP_FAIL,this.changeStateShipFail.bind(this)),this.onAttack()},clockOverTime:function(){var t=this,e=this.node.children[0].children[0].getComponent(cc.Label),n="BOY IS OVER TIME",s="YOURS TURN HAS FINISHED";cc.tween(e.node).call(function(){e.string=n}).delay(1).call(function(){e.string=s}).delay(1).call(function(){i.instance.emit(o.CHANGE_SCENE,!0)}).call(function(){t.onAttack()}).start()},onAttack:function(){this.node.children[0].children[0].getComponent(cc.Label).string="SHOOTING SHIP ENEMY"},onFinal:function(){var t=this,e=this.node.children[0].children[0].getComponent(cc.Label),n="CHICKEN BOYS",s="YOURS TURN HAS FINISHED";cc.tween(e.node).call(function(){e.string=n}).delay(1).call(function(){e.string=s}).delay(1).call(function(){i.instance.emit(o.CHANGE_SCENE,!0)}).call(function(){t.onAttack()}).start()},onAttackToAttack:function(){var t=this,e=this.node.children[0].children[0].getComponent(cc.Label),n="GOOD BOYS",s="U HAS HIT ENEMY SHIP",r="SHOOT AGAIN";cc.tween(e.node).call(function(){e.string=n}).delay(1).call(function(){e.string=s}).delay(1).call(function(){e.string=r,i.instance.emit(o.CHANGE_SCENE,!1)}).call(function(){t.onAttack()}).start()},onShipFail:function(){var t=this;cc.log("pirate taking");var e=this.node.children[0].children[0].getComponent(cc.Label),n="GOOD BOYS",s="ENEMY SHIP HAS FAILED",r="GOOD JOBS",c="SHOOT AGAIN";cc.tween(e.node).call(function(){e.string=n}).delay(1).call(function(){e.string=s}).delay(1).call(function(){e.string=r}).delay(1).call(function(){e.string=c,i.instance.emit(o.SHIP_FAIL_CHECK),t.onAttack()}).start()},changeStateShipFail:function(){this.onShipFail()},handleState:function(t){cc.log("pre"+t),!0===t?this.onAttackToAttack():!1===t?this.onFinal():void 0===t&&(cc.log("pirate final"),this.clockOverTime())},update:function(){}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT","javascript-state-machine":2}],PlayerController:[function(t,e,n){"use strict";cc._RF.push(e,"3022fJBh1FFwaAJRQs5S41T","PlayerController");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{map:cc.Node,shipBool:cc.Node},onLoad:function(){this.playerId=this.generateRandomId(),this.registerEvent()},start:function(){},loadTheShip:function(){var t=this;i.instance.emit(o.SOUND_CLICK);var e=this.node.children[0].getChildren();this.ships=[],e.forEach(function(e){"ship"===e.name&&t.ships.push(e.getComponent("Ship"))}),this.ships.length<4?cc.log("Vui l\xf2ng ch\u1ecdn \u0111\u1ee7 t\xe0u"):(i.instance.emit("SavePlayerId",this.playerId),i.instance.emit("START",this.playerId),this.shipBool.active=!1,this.turnOffDraDrop())},turnOffDraDrop:function(){this.ships.forEach(function(t){t.node.getComponent("dradropGameObject").turnOffListener()})},getShipById:function(t){for(var e=0;e<this.ships.length;e++)if(this.ships[e].shipId==t)return this.ships[e];this.ships.forEach(function(e){if(e.shipId==t)return e})},updateLength:function(t){var e=this.getShipById(t);return e.length-=1,e.length},responeResult:function(t){if(this.playerId==t.playerId)if(null==t.shipId)cc.log("hut"),i.instance.emit(o.SEND_RESULT,{isHit:!1,worldPosition:t.worldPosition});else{var e=this.updateLength(t.shipId);if(0==e)cc.log("no"),i.instance.emit(o.SEND_RESULT,{isHit:!0,worldPosition:t.worldPosition,shipLength:e}),i.instance.emit(o.COMPLETE_HIT_SHIP,t.shipId);else{cc.log("trung"),i.instance.emit(o.SEND_RESULT,{isHit:!0,worldPosition:t.worldPosition,shipLength:e});var n=t.position;cc.log("enemy call:",t),i.instance.emit(o.HIT_SHIP,{shipId:t.shipId,position:{row:n.y,column:n.x}})}}},sendCoordinates:function(t){cc.log({playerId:this.playerId,position:t}),i.instance.emit("POSITION",{playerId:this.playerId,position:t})},checkPositon:function(t){cc.log(t),this.playerId==t.playerId&&i.instance.emit("checkTile",{playerId:this.playerId,position:t.position})},generateRandomId:function(){return Math.floor(Math.random()*Date.now()).toString()},registerEvent:function(){i.instance.registerEvent(o.CHECK_POSITION,this.checkPositon.bind(this)),i.instance.registerEvent("receiveresult",this.responeResult.bind(this)),i.instance.registerEvent("sendCoordinates",this.sendCoordinates.bind(this))}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],Position:[function(t,e,n){"use strict";cc._RF.push(e,"eab40akdMhIfpqnZrls+Clw","Position");var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(e,n){o(this,t),this._x=e,this._y=n}return i(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}}]),t}();e.exports=s,cc._RF.pop()},{}],Ship:[function(t,e,n){"use strict";cc._RF.push(e,"306811SyINK4YlworkZ43RU","Ship");var i=t("Position"),o=t("EventEmitter"),s=cc.Class({extends:cc.Component,properties:{length:0},ctor:function(t,e){this.length=t,this.isHorizontal=e,this.shipId=this.generateRandomId(),this.anchorIndex=Math.floor(this.length/2),this.positions=[],this.creatPos()},onLoad:function(){null==this.shipId&&(this.shipId=this.generateRandomId()),this.isHorizontal=!0,this.anchorIndex=Math.floor(this.length/2),this.positions=[],this.creatPos()},creatPos:function(){for(var t=0;t<this.length;t++)this.positions.push(new i(0,0))},calculatePosition:function(t,e,n){if(this.positions[this.anchorIndex].x=t,this.positions[this.anchorIndex].y=e,this.isHorizontal){for(var i=this.anchorIndex-1;i>=0;i--)this.positions[i].x=t-(this.anchorIndex-i),this.positions[i].y=e;for(var s=this.anchorIndex+1;s<=this.length-1;s++)this.positions[s].x=t+(s-this.anchorIndex),this.positions[s].y=e}else{for(var r=this.anchorIndex-1;r>=0;r--)this.positions[r].x=t,this.positions[r].y=e-(this.anchorIndex-r);for(var c=this.anchorIndex+1;c<=this.length-1;c++)this.positions[c].x=t,this.positions[c].y=e+(c-this.anchorIndex)}n&&o.instance.emit("selected",{positions:this.positions,shipId:this.shipId})},generateRandomId:function(){return Math.floor(Math.random()*Date.now()).toString()},playanimOnWater:function(){var t=cc.scaleTo(3,.9),e=cc.scaleTo(3,1),n=cc.sequence(t,e),i=cc.repeatForever(n);this.node.getChildByName("shipSprite").runAction(i)},changeRotation:function(){cc.log("rotation"),this.isHorizontal=!this.isHorizontal,this.isHorizontal?this.node.rotation=0:this.node.rotation=90,this.calculatePosition(this.positions[this.anchorIndex].x,this.positions[this.anchorIndex].y,!0)}});e.exports=s,cc._RF.pop()},{EventEmitter:"EventEmitter",Position:"Position"}],TestButton:[function(t,e,n){"use strict";cc._RF.push(e,"1ca18SXw2NLY4LIR1nX93u3","TestButton");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{player:cc.Node},onLoad:function(){this.position={x:0,y:0}},start:function(){},test:function(){i.instance.emit("checkposition",{playerId:this.player.getComponent("PlayerController").playerId,position:this.position})}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],Test:[function(t,e,n){"use strict";cc._RF.push(e,"7fb826mX7BOwYHcVU6A8Cmk","Test");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},sendResult:function(t){var e={isHit:!0,shipLength:0,worldPosition:t.position};i.instance.emit(o.SEND_RESULT,e)},start:function(){}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],Tile:[function(t,e,n){"use strict";cc._RF.push(e,"3df79YCTr9Oq7rzT6lDba87","Tile"),cc.Class({extends:cc.Component,properties:{cover:cc.Node,activeColor:cc.Color,effect:[cc.Prefab],shipId:null,isShooted:!1},active:function(t){t?(this.cover.active=!0,this.cover.color=this.activeColor):this.cover.active=!1},select:function(){(this.isHasShip?cc.instantiate(this.effect[0]):cc.instantiate(this.effect[1])).parent=this.node},changeState:function(){null==this.shipId?(this.cover.active=!0,this.cover.color=this.activeColor=cc.color(80,80,80,180)):(this.cover.active=!0,this.cover.color=this.activeColor=cc.color(255,0,0,180))}}),cc._RF.pop()},{}],VfxController:[function(t,e,n){"use strict";cc._RF.push(e,"d0a7dAmlqtN46G74qJ7/Tp4","VfxController");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{bomPrefab:cc.Prefab,missPrefab:cc.Prefab,explosionShip:cc.Prefab},onLoad:function(){this.shipLenght=0,this.bom,this.isHit=!1,i.instance.registerEvent(o.PLAY_ANI,this.playAnimation.bind(this)),i.instance.registerEvent(o.DESTROY_ANI_NODE,this.destroyNode.bind(this)),this.animation=null},playAnimation:function(t){if(this.isHit=t.isHit,this.shipLength=t.shipLength,this.bom=cc.instantiate(this.bomPrefab),this.bom.setParent(this.node.parent.parent.parent),this.bom.position=t.worldPosition,this.isHit){var e=this.bom.getComponent(cc.Animation);e.play(e.getClips()[0].name),i.instance.emit(o.SOUND_EXPLOSION),0!==this.shipLength&&i.instance.emit(o.IS_SHOOT_SHIP,!0)}else{var n=this.bom.getComponent(cc.Animation);n.play(n.getClips()[1].name),i.instance.emit(o.SOUND_SHOOT_WATER),0!==this.shipLength&&i.instance.emit(o.IS_SHOOT_SHIP,!1)}},destroyNode:function(){0===this.shipLength&&i.instance.emit(o.SHIP_FAIL),this.bom.destroy()}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],dradropGameObject:[function(t,e,n){"use strict";cc._RF.push(e,"56371aesqZE4IqgNLaxJtZD","dradropGameObject");var i=t("EventEmitter");cc.Class({extends:cc.Component,properties:{map:cc.Node,container:cc.Node,isAvailable:!1,touchDelay:.2},onLoad:function(){this.offset=cc.Vec2.ZERO,this.isDragging=!1,this.isDoubleClick=!1,this.count=0,this.lastTouchTime=0,this.convertPos=new cc.Vec2},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),i.instance.registerEvent("setAvailable",this.setAvailable.bind(this)),this.node.getComponent("Ship").playanimOnWater()},onTouchStart:function(t){cc.log("start"),this.node.getChildByName("shipSprite").stopAllActions(),this.node.parent==this.container&&(this.container.getComponent(cc.Layout).active=!1,this.node.parent=this.container.parent.parent,this.node.position=new cc.Vec2(this.node.x+this.container.x+this.container.parent.x,this.node.y+this.container.y+this.container.parent.y)),this.isDragging=!0;var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.offset=this.node.position.sub(e)},onTouchMove:function(t){if(this.isDragging){var e=this.node.parent.convertToNodeSpaceAR(t.getLocation());this.node.position=e.add(this.offset);var n=new cc.Vec2(this.node.x-this.map.x,this.node.y-this.map.y);this.convertPosition(n)}},onTouchEnd:function(t){cc.log("c\xf3 ch\u1ea1y tochend");var e=this.lastTouchTime?this.lastTouchTime:0;this.lastTouchTime=Date.now(),this.lastTouchTime-e<500?(this.isDoubleClick=!0,cc.log("doubleTap"),this.node.getComponent("Ship").changeRotation()):(this.isDoubleClick=!1,this.endTochAction());var n=(new Date).getTime();this.lastTouchTime=n},convertPosition:function(t){var e=t.x-30,n=t.y+30,i=Math.round(e/55),o=Math.round(n/55),s=new cc.Vec2(55*i,55*o);this.node.getComponent("Ship").calculatePosition(i,-1*o,!0),this.convertPos=new cc.Vec2(s.x+this.map.x+30,s.y+this.map.y-30)},setAvailable:function(t){this.node.getComponent("Ship").shipId==t.shipId&&(this.isAvailable=t.isAvailable,this.isDoubleClick&&(this.endTochAction(),this.isDoubleClick=!1))},endTochAction:function(){this.node.position=this.convertPos,this.isDragging=!1,0==this.isAvailable?(this.container.getComponent(cc.Layout).active=!0,this.node.parent=this.container,this.node.x=0,this.node.getComponent("Ship").isHorizontal=!0,this.node.rotation=0,i.instance.emit("clear",{shipId:this.node.getComponent("Ship").shipId}),i.instance.emit("clearShipId",this.node.getComponent("Ship").shipId)):i.instance.emit("setShipId",{positions:this.node.getComponent("Ship").positions,shipId:this.node.getComponent("Ship").shipId}),this.node.getComponent("Ship").playanimOnWater()},turnOffListener:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)}}),cc._RF.pop()},{EventEmitter:"EventEmitter"}],gameOverManager:[function(t,e,n){"use strict";cc._RF.push(e,"e5434q1V+1P04GdrfotDNBL","gameOverManager");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{winPanel:cc.Node,losePanel:cc.Node},onLoad:function(){var t=this.openWinPanel.bind(this),e=this.openLosePanel.bind(this);i.instance.registerEvent(o.WIN,t),i.instance.registerEvent(o.LOSE,e)},start:function(){this.winPanel.active=!1,this.losePanel.active=!1},openWinPanel:function(){this.winPanel.active=!0},openLosePanel:function(){this.losePanel.active=!0}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],loginManager:[function(t,e,n){"use strict";cc._RF.push(e,"3e5a4Szn7hCRJELoZIxqkqk","loginManager");var i={value:0};cc.Class({extends:cc.Component,properties:{loginScene:cc.Node,loadingScene:cc.Node,loadingWaves:cc.Node,yStart:40,yEnd:280,speed:100,percentLabel:cc.Label},start:function(){this.loginScene.active=!0,this.loadingScene.active=!1},update:function(t){this.setPercentLabel(Math.floor(i.value))},setPercentLabel:function(t){this.percentLabel.string=t+"%"},loading:function(){var t=this;this.loginScene.active=!1,this.loadingScene.active=!0;this.yEnd,this.yStart;cc.tween(i).delay(.5).to(.5,{value:20}).delay(.5).to(.4,{value:30}).delay(.4).to(.3,{value:60}).delay(.3).to(.3,{value:65}).delay(.3).to(.2,{value:90}).delay(.2).call(function(){t.loadMainScene()}).to(1,{value:100}).start(),cc.tween(this.loadingWaves).to(5.2,{y:this.yEnd}).start()},loadMainScene:function(){cc.director.loadScene("mainScene")}}),cc._RF.pop()},{}],rands:[function(t,e,n){"use strict";cc._RF.push(e,"391e2mRLk9BobPkb7nRaVip","rands");var i=[[0,-1],[0,1]],o=[[-1,0],[1,0]],s=[].concat(i,o),r=function(t,e){return e||(e=t,t=0),Math.floor(Math.random()*(e-t+1))+t},c=function(t){return t[r(t.length-1)]},a=function(t,e){return{row:t.row+e[0],column:t.column+e[1]}},h=function(t,e,n){return t.row>=0&&t.row<e&&t.column>=0&&t.column<n},l=function(t,e,n){var i={};do{var o=c(s);i=a(t,o)}while(!h(i,e,n));return i},p=function(t,e,n,i,o){var s={},r=[a(t,o[0]),a(e,o[1])];do{s=c(r)}while(!h(s,n,i));return s},u=function(t,e,n){if(1===t.length)return l(t[0],e,n);t.sort(function(t,e){return t.row-e.row||t.column-e.column});var s=t[0],r=t[t.length-1],c=s.row-r.row==0;return p(s,r,e,n,c?i:o)};e.exports={random:r,randomInArray:c,randomPosition:function(t,e){return{row:r(t-1),column:r(e-1)}},randomHitShip:function(t,e,n){var i=t[c(Object.keys(t))];return u(i,e,n)}},cc._RF.pop()},{}],soundManager:[function(t,e,n){"use strict";cc._RF.push(e,"d0b80fTuKRFEq5VkWdGERVU","soundManager");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{mainMusic:cc.AudioSource,sounds:[cc.AudioSource]},onLoad:function(){var t=this.canonShoot.bind(this),e=this.explosion.bind(this),n=this.shootWater.bind(this),s=this.click.bind(this);i.instance.registerEvent(o.SOUND_CANON_SHOOT,t),i.instance.registerEvent(o.SOUND_SHOOT_WATER,n),i.instance.registerEvent(o.SOUND_EXPLOSION,e),i.instance.registerEvent(o.SOUND_CLICK,s)},start:function(){this.mainMusic.play()},canonShoot:function(){this.playSound("explosion")},explosion:function(){this.playSound("explosion")},shootWater:function(){this.playSound("shoot_water")},click:function(){this.playSound("click")},playSound:function(t){this.sounds.forEach(function(e){e.node.name!=t||e.play()})},changeMusicVolume:function(t){this.mainMusic.volume=t},changeSoundsVolume:function(t){this.sounds.forEach(function(e){e.volume=t})}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],turnController:[function(t,e,n){"use strict";cc._RF.push(e,"98f7d9rySNGXKRqRWEY6XQe","turnController");var i=t("EventEmitter"),o=t("NAME_EVENT");cc.Class({extends:cc.Component,properties:{yourTurnPanel:cc.Node,xStartYourTurn:-1500,enemyTurnPanel:cc.Node,xStartEnemyTurn:1500,circleLoading:cc.Node,loadingLabel:cc.Label},onLoad:function(){this.circleLoading.parent.active=!1;var t=this.yourTurn.bind(this),e=this.enemyTurn.bind(this),n=this.waitForEnemy.bind(this);i.instance.registerEvent(o.YOUR_TURN_PANEL,t),i.instance.registerEvent(o.ENEMY_TURN_PANEL,e),i.instance.registerEvent(o.WAIT_FOR_ENEMY,n)},start:function(){this.resetPosition()},resetPosition:function(){this.yourTurnPanel.x=this.xStartYourTurn,this.enemyTurnPanel.x=this.xStartEnemyTurn,this.yourTurnPanel.active=!1,this.enemyTurnPanel.active=!1},yourTurn:function(){var t=this;this.yourTurnPanel.active=!0;var e=cc.sequence(cc.moveTo(.5,-20,0),cc.moveTo(1,20,0),cc.moveTo(.5,1500,0),cc.callFunc(function(){t.resetPosition(),i.instance.emit(o.YOUR_TURN_PANEL_DONE)}));this.yourTurnPanel.runAction(e)},enemyTurn:function(){var t=this;this.enemyTurnPanel.active=!0;var e=cc.sequence(cc.moveTo(.5,20,0),cc.moveTo(1,-20,0),cc.moveTo(.5,-1500,0),cc.callFunc(function(){t.resetPosition(),i.instance.emit(o.ENEMY_TURN_PANEL_DONE)}));this.enemyTurnPanel.runAction(e)},waitForEnemy:function(){var t=this;this.circleLoading.parent.active=!0;var e=cc.sequence(cc.spawn(cc.rotateTo(3,180),cc.callFunc(function(){t.loadingLabel.string="WAITING ENEMY"})),cc.spawn(cc.delayTime(1),cc.callFunc(function(){t.loadingLabel.string="START"})),cc.callFunc(function(){t.circleLoading.rotation=0,t.circleLoading.parent.active=!1,i.instance.emit(o.WAIT_FOR_ENEMY_DONE)}));this.circleLoading.runAction(e)}}),cc._RF.pop()},{EventEmitter:"EventEmitter",NAME_EVENT:"NAME_EVENT"}],waveController:[function(t,e,n){"use strict";cc._RF.push(e,"97536XFv0NCvL6LY3ePOzI6","waveController"),cc.Class({extends:cc.Component,properties:{posX:0,posY:0},start:function(){this.posX=this.node.x,this.posY=this.node.y;var t=cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(2,this.random(1,1.3),this.random(1,1.1)),cc.moveTo(2,this.random(this.posX,this.posX+5),this.random(this.posY,this.posY+5))),cc.spawn(cc.scaleTo(2,1,1),cc.moveTo(2,this.random(this.posX,this.posX-5,this.posY),this.random(this.posY,this.posY-5)))));this.node.runAction(t)},random:function(t,e){return Math.random()*(e-t)+t}}),cc._RF.pop()},{}]},{},["EnemyController","EventController","LoadEnemyShip","EventCode","EventEmitter","AnimationState","Bom","ClockController","Emitter","FindTileInMap","GameController","MainController","MapController","NAME_EVENT","PirateContoller","Test","VfxController","gameOverManager","loginManager","waveController","EnemyMap","EnemyShipBool","EnemyShipDisplay","Map","PlayerController","Position","Ship","TestButton","Tile","dradropGameObject","soundManager","turnController","rands"]);